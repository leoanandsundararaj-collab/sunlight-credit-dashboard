<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Sunlight Financial - Credit Risk Intelligence Platform</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, 'Helvetica Neue', Arial, sans-serif;
            background: linear-gradient(135deg, #1e3a8a 0%, #1e40af 100%);
            color: #333;
            min-height: 100vh;
        }

        .header {
            background: #1e3a8a;
            color: white;
            padding: 1.5rem 2rem;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
        }

        .header h1 {
            font-size: 1.75rem;
            margin-bottom: 0.25rem;
            font-weight: 600;
        }

        .header p {
            font-size: 0.9rem;
            opacity: 0.9;
            font-weight: 300;
        }

        .nav-tabs {
            background: white;
            display: flex;
            gap: 0;
            padding: 0 2rem;
            box-shadow: 0 2px 5px rgba(0,0,0,0.05);
            overflow-x: auto;
        }

        .nav-tab {
            padding: 1rem 1.5rem;
            cursor: pointer;
            border: none;
            background: transparent;
            font-size: 0.95rem;
            font-weight: 500;
            color: #64748b;
            border-bottom: 3px solid transparent;
            transition: all 0.2s;
            white-space: nowrap;
        }

        .nav-tab:hover {
            color: #1e40af;
            background: #f1f5f9;
        }

        .nav-tab.active {
            color: #1e40af;
            border-bottom-color: #1e40af;
            background: #f8fafc;
        }

        .container {
            max-width: 1400px;
            margin: 0 auto;
            padding: 2rem;
        }

        .tab-content {
            display: none;
        }

        .tab-content.active {
            display: block;
            animation: fadeIn 0.3s;
        }

        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(10px); }
            to { opacity: 1; transform: translateY(0); }
        }

        .kpi-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 1.5rem;
            margin-bottom: 2rem;
        }

        .kpi-card {
            background: white;
            padding: 1.5rem;
            border-radius: 12px;
            box-shadow: 0 2px 8px rgba(0,0,0,0.08);
        }

        .kpi-label {
            font-size: 0.85rem;
            color: #64748b;
            text-transform: uppercase;
            letter-spacing: 0.5px;
            margin-bottom: 0.5rem;
            font-weight: 600;
        }

        .kpi-value {
            font-size: 2rem;
            font-weight: 700;
            color: #1e293b;
            margin-bottom: 0.25rem;
        }

        .kpi-trend {
            font-size: 0.85rem;
            color: #10b981;
        }

        .kpi-trend.down {
            color: #ef4444;
        }

        .card {
            background: white;
            border-radius: 12px;
            padding: 1.5rem;
            margin-bottom: 1.5rem;
            box-shadow: 0 2px 8px rgba(0,0,0,0.08);
        }

        .card-header {
            font-size: 1.25rem;
            font-weight: 600;
            color: #1e293b;
            margin-bottom: 1rem;
            padding-bottom: 0.75rem;
            border-bottom: 2px solid #f1f5f9;
        }

        table {
            width: 100%;
            border-collapse: collapse;
            margin-top: 1rem;
        }

        th {
            background: #f8fafc;
            padding: 0.75rem;
            text-align: left;
            font-weight: 600;
            color: #475569;
            font-size: 0.875rem;
            border-bottom: 2px solid #e2e8f0;
            cursor: pointer;
            user-select: none;
        }

        th:hover {
            background: #f1f5f9;
        }

        td {
            padding: 0.75rem;
            border-bottom: 1px solid #f1f5f9;
            font-size: 0.9rem;
        }

        tr:hover {
            background: #fafafa;
        }

        .badge {
            display: inline-block;
            padding: 0.25rem 0.75rem;
            border-radius: 12px;
            font-size: 0.8rem;
            font-weight: 600;
        }

        .badge-success {
            background: #dcfce7;
            color: #166534;
        }

        .badge-warning {
            background: #fef3c7;
            color: #92400e;
        }

        .badge-danger {
            background: #fee2e2;
            color: #991b1b;
        }

        .badge-info {
            background: #dbeafe;
            color: #1e40af;
        }

        .chat-container {
            background: white;
            border-radius: 12px;
            padding: 1.5rem;
            margin-bottom: 1.5rem;
            box-shadow: 0 2px 8px rgba(0,0,0,0.08);
        }

        .chat-messages {
            max-height: 500px;
            overflow-y: auto;
            margin-bottom: 1rem;
            padding: 1rem;
            background: #f8fafc;
            border-radius: 8px;
        }

        .message {
            margin-bottom: 1.5rem;
            padding: 1rem;
            border-radius: 8px;
        }

        .message.user {
            background: #dbeafe;
            margin-left: 20%;
        }

        .message.assistant {
            background: white;
            margin-right: 20%;
            box-shadow: 0 1px 3px rgba(0,0,0,0.1);
        }

        .message-label {
            font-size: 0.75rem;
            color: #64748b;
            margin-bottom: 0.5rem;
            font-weight: 600;
        }

        .sample-questions {
            display: flex;
            flex-wrap: wrap;
            gap: 0.75rem;
            margin-bottom: 1rem;
        }

        .sample-btn {
            padding: 0.75rem 1rem;
            background: #f1f5f9;
            border: 1px solid #e2e8f0;
            border-radius: 8px;
            cursor: pointer;
            font-size: 0.9rem;
            transition: all 0.2s;
            color: #475569;
        }

        .sample-btn:hover {
            background: #e2e8f0;
            border-color: #cbd5e1;
        }

        .alert-row {
            border-left: 4px solid #ef4444;
            background: #fef2f2;
        }

        .alert-row.medium {
            border-left-color: #f59e0b;
            background: #fffbeb;
        }

        .high-risk-row {
            background: #fef2f2;
        }

        .filter-controls {
            display: flex;
            gap: 1rem;
            margin-bottom: 1rem;
        }

        select {
            padding: 0.5rem 1rem;
            border: 1px solid #e2e8f0;
            border-radius: 6px;
            font-size: 0.9rem;
            background: white;
            cursor: pointer;
        }

        .chart-placeholder {
            background: #f8fafc;
            height: 300px;
            border-radius: 8px;
            display: flex;
            align-items: center;
            justify-content: center;
            color: #94a3b8;
            font-size: 0.9rem;
            border: 2px dashed #e2e8f0;
        }
    </style>
</head>
<body>
    <div class="header">
        <h1>Sunlight Financial - Credit Risk Intelligence Platform</h1>
        <p>Powered by Altair Graph Studio &amp; AI CoPilot</p>
    </div>

    <div class="nav-tabs">
        <button class="nav-tab active" onclick="showTab('portfolio')">Portfolio Overview</button>
        <button class="nav-tab" onclick="showTab('contractor')">Contractor Risk</button>
        <button class="nav-tab" onclick="showTab('warnings')">Early Warning Signals</button>
        <button class="nav-tab" onclick="showTab('geographic')">Geographic Risk</button>
        <button class="nav-tab" onclick="showTab('copilot')">AI CoPilot</button>
    </div>

    <div class="container">
        <!-- Portfolio Overview Tab -->
        <div id="portfolio" class="tab-content active">
            <div class="kpi-grid">
                <div class="kpi-card">
                    <div class="kpi-label">Total Portfolio Value</div>
                    <div class="kpi-value">$52.6M</div>
                    <div class="kpi-trend">â†‘ 12.4% YTD</div>
                </div>
                <div class="kpi-card">
                    <div class="kpi-label">Active Loans</div>
                    <div class="kpi-value">1,209</div>
                    <div class="kpi-trend">â†‘ 8.2% vs last month</div>
                </div>
                <div class="kpi-card">
                    <div class="kpi-label">Delinquency Rate</div>
                    <div class="kpi-value">3.87%</div>
                    <div class="kpi-trend">â†“ 0.3% vs last month</div>
                </div>
                <div class="kpi-card">
                    <div class="kpi-label">Average Risk Score</div>
                    <div class="kpi-value">58.8</div>
                    <div class="kpi-trend down">Monitor closely</div>
                </div>
            </div>

            <div class="card">
                <div class="card-header">Portfolio Risk Trend (Last 180 Days)</div>
                <div class="chart-placeholder">
                    ðŸ“ˆ Interactive risk trend chart showing delinquency rates over time
                </div>
            </div>

            <div class="card">
                <div class="card-header">Recent High-Risk Loans</div>
                <table>
                    <thead>
                        <tr>
                            <th>Borrower ID</th>
                            <th>Contractor</th>
                            <th>Risk Score</th>
                            <th>Status</th>
                            <th>Loan Amount</th>
                        </tr>
                    </thead>
                    <tbody>
                        <tr>
                            <td>B1003</td>
                            <td>Sunshine Installations</td>
                            <td>62</td>
                            <td><span class="badge badge-warning">30 Days Late</span></td>
                            <td>$35,939</td>
                        </tr>
                        <tr>
                            <td>B1010</td>
                            <td>Elite Solar Group</td>
                            <td>58</td>
                            <td><span class="badge badge-warning">30 Days Late</span></td>
                            <td>$33,446</td>
                        </tr>
                        <tr>
                            <td>B1006</td>
                            <td>GreenTech Solar</td>
                            <td>73</td>
                            <td><span class="badge badge-success">Current</span></td>
                            <td>$38,897</td>
                        </tr>
                    </tbody>
                </table>
            </div>
        </div>

        <!-- Contractor Risk Tab -->
        <div id="contractor" class="tab-content">
            <div class="kpi-grid">
                <div class="kpi-card">
                    <div class="kpi-label">Total Contractors</div>
                    <div class="kpi-value">10</div>
                </div>
                <div class="kpi-card">
                    <div class="kpi-label">High-Risk Contractors</div>
                    <div class="kpi-value">2</div>
                    <div class="kpi-trend down">Default Rate &gt; 7%</div>
                </div>
                <div class="kpi-card">
                    <div class="kpi-label">Total Contractor Exposure</div>
                    <div class="kpi-value">$4.5M</div>
                </div>
            </div>

            <div class="card">
                <div class="card-header">Contractor Risk Analysis</div>
                <table id="contractorTable">
                    <thead>
                        <tr>
                            <th onclick="sortTable('contractorTable', 0)">Contractor Name</th>
                            <th onclick="sortTable('contractorTable', 1)">Total Loans</th>
                            <th onclick="sortTable('contractorTable', 2)">Total Volume</th>
                            <th onclick="sortTable('contractorTable', 3)">Avg Risk Score</th>
                            <th onclick="sortTable('contractorTable', 4)">Default Rate %</th>
                            <th>Risk Status</th>
                        </tr>
                    </thead>
                    <tbody>
                        <tr class="high-risk-row">
                            <td><strong>Sunshine Installations</strong></td>
                            <td>11</td>
                            <td>$354,106</td>
                            <td>48.6</td>
                            <td>9.09%</td>
                            <td><span class="badge badge-danger">High Risk</span></td>
                        </tr>
                        <tr class="high-risk-row">
                            <td><strong>Elite Solar Group</strong></td>
                            <td>12</td>
                            <td>$354,230</td>
                            <td>45.8</td>
                            <td>8.33%</td>
                            <td><span class="badge badge-danger">High Risk</span></td>
                        </tr>
                        <tr>
                            <td>PowerSun Contractors</td>
                            <td>21</td>
                            <td>$595,243</td>
                            <td>45.8</td>
                            <td>4.76%</td>
                            <td><span class="badge badge-warning">Medium Risk</span></td>
                        </tr>
                        <tr>
                            <td>Bright Future Energy</td>
                            <td>21</td>
                            <td>$628,237</td>
                            <td>74.2</td>
                            <td>0.00%</td>
                            <td><span class="badge badge-success">Low Risk</span></td>
                        </tr>
                        <tr>
                            <td>GreenTech Solar</td>
                            <td>11</td>
                            <td>$381,762</td>
                            <td>77.3</td>
                            <td>0.00%</td>
                            <td><span class="badge badge-success">Low Risk</span></td>
                        </tr>
                    </tbody>
                </table>
            </div>
        </div>

        <!-- Early Warning Signals Tab -->
        <div id="warnings" class="tab-content">
            <div class="kpi-grid">
                <div class="kpi-card">
                    <div class="kpi-label">Total Active Warnings</div>
                    <div class="kpi-value">20</div>
                </div>
                <div class="kpi-card">
                    <div class="kpi-label">High Severity Alerts</div>
                    <div class="kpi-value">12</div>
                    <div class="kpi-trend down">Requires immediate review</div>
                </div>
                <div class="kpi-card">
                    <div class="kpi-label">Medium Severity Alerts</div>
                    <div class="kpi-value">8</div>
                    <div class="kpi-trend">Monitor closely</div>
                </div>
                <div class="kpi-card">
                    <div class="kpi-label">Potential Loss Exposure</div>
                    <div class="kpi-value">$1.2M</div>
                </div>
            </div>

            <div class="card">
                <div class="card-header">AI-Powered Early Warning Detection System</div>
                <p style="color: #64748b; margin-bottom: 1rem; font-size: 0.95rem;">Identifying risks before they become losses</p>
                
                <div class="filter-controls">
                    <select id="severityFilter" onchange="filterWarnings()">
                        <option value="all">All Severities</option>
                        <option value="High">High Only</option>
                        <option value="Medium">Medium Only</option>
                    </select>
                    <select id="warningTypeFilter" onchange="filterWarnings()">
                        <option value="all">All Warning Types</option>
                        <option value="Production Underperformance">Production Underperformance</option>
                        <option value="Contractor Risk Cluster">Contractor Risk Cluster</option>
                        <option value="Identity Anomaly">Identity Anomaly</option>
                    </select>
                </div>

                <table id="warningsTable">
                    <thead>
                        <tr>
                            <th>Borrower ID</th>
                            <th>Contractor</th>
                            <th>Warning Type</th>
                            <th>Severity</th>
                            <th>Risk Score</th>
                            <th>Recommended Action</th>
                        </tr>
                    </thead>
                    <tbody>
                        <tr class="alert-row">
                            <td>B1006</td>
                            <td>GreenTech Solar</td>
                            <td>Contractor Risk Cluster</td>
                            <td><span class="badge badge-danger">High</span></td>
                            <td>73</td>
                            <td>Immediate Review</td>
                        </tr>
                        <tr class="alert-row">
                            <td>B1013</td>
                            <td>Bright Future Energy</td>
                            <td>Contractor Risk Cluster</td>
                            <td><span class="badge badge-danger">High</span></td>
                            <td>76</td>
                            <td>Immediate Review</td>
                        </tr>
                        <tr class="alert-row medium">
                            <td>B1015</td>
                            <td>Bright Future Energy</td>
                            <td>Income Inconsistency</td>
                            <td><span class="badge badge-warning">Medium</span></td>
                            <td>71</td>
                            <td>Monitor Closely</td>
                        </tr>
                        <tr class="alert-row">
                            <td>B1019</td>
                            <td>Bright Future Energy</td>
                            <td>Production Underperformance</td>
                            <td><span class="badge badge-danger">High</span></td>
                            <td>71</td>
                            <td>Immediate Review</td>
                        </tr>
                        <tr class="alert-row medium">
                            <td>B1026</td>
                            <td>Bright Future Energy</td>
                            <td>Identity Anomaly</td>
                            <td><span class="badge badge-warning">Medium</span></td>
                            <td>67</td>
                            <td>Monitor Closely</td>
                        </tr>
                    </tbody>
                </table>
            </div>
        </div>

        <!-- Geographic Risk Tab -->
        <div id="geographic" class="tab-content">
            <div class="kpi-grid">
                <div class="kpi-card">
                    <div class="kpi-label">Highest Risk State</div>
                    <div class="kpi-value">CA</div>
                    <div class="kpi-trend down">4.88% delinquency rate</div>
                </div>
                <div class="kpi-card">
                    <div class="kpi-label">States Monitored</div>
                    <div class="kpi-value">10</div>
                </div>
                <div class="kpi-card">
                    <div class="kpi-label">Geographic Concentration</div>
                    <div class="kpi-value">27%</div>
                    <div class="kpi-trend">California exposure</div>
                </div>
            </div>

            <div class="card">
                <div class="card-header">Geographic Risk Heatmap</div>
                <table>
                    <thead>
                        <tr>
                            <th>State</th>
                            <th>Total Loans</th>
                            <th>Avg Risk Score</th>
                            <th>Delinquent Count</th>
                            <th>Delinquency Rate %</th>
                            <th>Risk Level</th>
                        </tr>
                    </thead>
                    <tbody>
                        <tr class="high-risk-row">
                            <td><strong>CA</strong></td>
                            <td>41</td>
                            <td>53.4</td>
                            <td>2</td>
                            <td>4.88%</td>
                            <td><span class="badge badge-danger">High</span></td>
                        </tr>
                        <tr>
                            <td><strong>AZ</strong></td>
                            <td>25</td>
                            <td>51.4</td>
                            <td>1</td>
                            <td>4.00%</td>
                            <td><span class="badge badge-warning">Medium</span></td>
                        </tr>
                        <tr>
                            <td>TX</td>
                            <td>20</td>
                            <td>48.4</td>
                            <td>0</td>
                            <td>0.00%</td>
                            <td><span class="badge badge-success">Low</span></td>
                        </tr>
                        <tr>
                            <td>NC</td>
                            <td>14</td>
                            <td>53.2</td>
                            <td>0</td>
                            <td>0.00%</td>
                            <td><span class="badge badge-success">Low</span></td>
                        </tr>
                        <tr>
                            <td>FL</td>
                            <td>11</td>
                            <td>46.0</td>
                            <td>0</td>
                            <td>0.00%</td>
                            <td><span class="badge badge-success">Low</span></td>
                        </tr>
                    </tbody>
                </table>
            </div>
        </div>

        <!-- AI CoPilot Tab -->
        <div id="copilot" class="tab-content">
            <div class="chat-container">
                <div class="card-header">Altair AI CoPilot - Your Intelligent Risk Assistant</div>
                <p style="color: #64748b; margin-bottom: 1.5rem; font-size: 0.95rem;">Ask questions in natural language, get instant insights</p>
                
                <div class="sample-questions">
                    <button class="sample-btn" onclick="askQuestion(1)">Which contractors have the highest default rates?</button>
                    <button class="sample-btn" onclick="askQuestion(2)">Show me loans at risk of early default</button>
                    <button class="sample-btn" onclick="askQuestion(3)">What's driving risk in California?</button>
                    <button class="sample-btn" onclick="askQuestion(4)">Identify borrowers with production underperformance</button>
                </div>

                <div class="chat-messages" id="chatMessages">
                    <div class="message assistant">
                        <div class="message-label">AI CoPilot</div>
                        <p>Hello! I'm your AI Credit Risk Intelligence Assistant. Click any of the sample questions above, or ask me anything about your portfolio risk, contractor performance, or borrower patterns. I can analyze relationships across your entire credit ecosystem and provide actionable recommendations.</p>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <script>
        function showTab(tabId) {
            // Hide all tabs
            document.querySelectorAll('.tab-content').forEach(tab => {
                tab.classList.remove('active');
            });
            
            // Remove active class from all nav buttons
            document.querySelectorAll('.nav-tab').forEach(btn => {
                btn.classList.remove('active');
            });
            
            // Show selected tab
            document.getElementById(tabId).classList.add('active');
            
            // Highlight active nav button
            event.target.classList.add('active');
        }

        function sortTable(tableId, columnIndex) {
            const table = document.getElementById(tableId);
            const tbody = table.querySelector('tbody');
            const rows = Array.from(tbody.querySelectorAll('tr'));
            
            rows.sort((a, b) => {
                const aValue = a.cells[columnIndex].textContent.trim();
                const bValue = b.cells[columnIndex].textContent.trim();
                
                // Try to parse as number
                const aNum = parseFloat(aValue.replace(/[^0-9.-]/g, ''));
                const bNum = parseFloat(bValue.replace(/[^0-9.-]/g, ''));
                
                if (!isNaN(aNum) && !isNaN(bNum)) {
                    return bNum - aNum;
                }
                return bValue.localeCompare(aValue);
            });
            
            rows.forEach(row => tbody.appendChild(row));
        }

        function filterWarnings() {
            const severityFilter = document.getElementById('severityFilter').value;
            const typeFilter = document.getElementById('warningTypeFilter').value;
            const table = document.getElementById('warningsTable');
            const rows = table.querySelectorAll('tbody tr');
            
            rows.forEach(row => {
                const severity = row.cells[3].textContent.trim();
                const type = row.cells[2].textContent.trim();
                
                const severityMatch = severityFilter === 'all' || severity.includes(severityFilter);
                const typeMatch = typeFilter === 'all' || type === typeFilter;
                
                if (severityMatch && typeMatch) {
                    row.style.display = '';
                } else {
                    row.style.display = 'none';
                }
            });
        }

        function askQuestion(questionNum) {
            const chatMessages = document.getElementById('chatMessages');
            
            const questions = {
                1: {
                    question: "Which contractors have the highest default rates?",
                    answer: `Based on current portfolio analysis, I've identified 2 contractors with elevated risk:

ðŸ”´ <strong>Sunshine Installations</strong>: 9.09% default rate (11 loans, $354K exposure)
ðŸ”´ <strong>Elite Solar Group</strong>: 8.33% default rate (12 loans, $354K exposure)

These contractors are performing 2-3x above portfolio average (3.87%). 

<strong>Recommended Actions:</strong>
1. Suspend new originations pending investigation
2. Review installation quality and payment patterns across their portfolio
3. Enhance due diligence requirements for future loans
4. Consider contractor re-certification and additional monitoring

<strong>Risk Impact:</strong> Combined exposure of $708,336 requires immediate attention to prevent further losses.`
                },
                2: {
                    question: "Show me loans at risk of early default",
                    answer: `I've identified <strong>20 loans with high early default risk</strong> based on knowledge graph analysis:

<strong>Top Risk Indicators:</strong>
â€¢ Production Underperformance: 6 loans showing 20-40% below expected solar output
â€¢ Contractor Risk Clusters: 8 loans tied to high-risk installers
â€¢ Identity Anomalies: 4 loans with shared devices or address overlaps
â€¢ Payment Delay Patterns: 2 loans with micro-delays not visible in servicing system

<strong>Highest Priority Borrowers:</strong>
â€¢ B1006 (Risk Score 73) - GreenTech Solar, contractor risk cluster
â€¢ B1013 (Risk Score 76) - Bright Future Energy, contractor risk + production issues
â€¢ B1019 (Risk Score 71) - Bright Future Energy, 35% production underperformance

<strong>Potential Loss Exposure:</strong> $1.2M if all high-severity alerts materialize

<strong>Recommended Actions:</strong>
â€¢ Immediate outreach to top 5 highest-risk borrowers
â€¢ Enhanced monitoring for contractor risk clusters
â€¢ Production verification for underperforming systems`
                },
                3: {
                    question: "What's driving risk in California?",
                    answer: `California shows <strong>4.88% delinquency rate</strong> (highest in portfolio) across 41 loans. Here's the risk breakdown:

<strong>Key Drivers:</strong>
1. <strong>Contractor Concentration:</strong> 65% of CA loans tied to 2 contractors with elevated risk profiles
2. <strong>Geographic Clustering:</strong> 8 loans in same zip code with similar production issues
3. <strong>System Underperformance:</strong> CA installations averaging 15% below expected production
4. <strong>Economic Factors:</strong> Regional income volatility in specific counties

<strong>Risk Comparison:</strong>
â€¢ CA Delinquency: 4.88%
â€¢ Portfolio Average: 3.87%
â€¢ Next Highest (AZ): 4.00%

<strong>Recommended Actions:</strong>
1. Adjust pricing for new CA originations (+0.25% rate premium)
2. Tighten underwriting for contractor-concentration zip codes
3. Require production verification for CA installations
4. Enhanced due diligence for loans > $30K in high-risk counties

<strong>Projected Impact:</strong> These actions could reduce CA delinquency to 3.5% within 90 days.`
                },
                4: {
                    question: "Identify borrowers with production underperformance",
                    answer: `Knowledge graph analysis reveals <strong>6 borrowers with significant solar production underperformance</strong>:

<strong>Critical Cases (>30% below expected):</strong>
â€¢ B1001: Expected 5,826 kWh, Actual 4,642 kWh (-20.3%)
â€¢ B1003: Expected 10,268 kWh, Actual 8,598 kWh (-16.3%)
â€¢ B1005: Expected 5,302 kWh, Actual 4,080 kWh (-23.1%)

<strong>Pattern Analysis:</strong>
â€¢ All 6 cases involve installations by same 2 contractors
â€¢ 4 of 6 are in California (potential shading or installation issues)
â€¢ Average underperformance: 22.4%
â€¢ Correlation with payment delays: 67%

<strong>Root Cause Indicators:</strong>
â€¢ Suboptimal panel placement or shading
â€¢ System maintenance issues
â€¢ Inverter malfunctions
â€¢ Initial production estimates inflated by contractors

<strong>Financial Impact:</strong>
Production shortfalls reduce borrower savings by average $840/year, increasing default probability by 2.3x

<strong>Recommended Actions:</strong>
1. Require third-party production audits for these 6 loans
2. Negotiate contractor remediation for installation defects
3. Adjust future production estimates for these contractors
4. Consider loan modification if borrower equity at risk`
                }
            };

            const q = questions[questionNum];
            
            // Add user question
            const userMsg = document.createElement('div');
            userMsg.className = 'message user';
            userMsg.innerHTML = `<div class="message-label">You</div><p>${q.question}</p>`;
            chatMessages.appendChild(userMsg);
            
            // Add AI response after short delay
            setTimeout(() => {
                const aiMsg = document.createElement('div');
                aiMsg.className = 'message assistant';
                aiMsg.innerHTML = `<div class="message-label">AI CoPilot</div><p>${q.answer}</p>`;
                chatMessages.appendChild(aiMsg);
                chatMessages.scrollTop = chatMessages.scrollHeight;
            }, 500);
        }
    </script>
</body>
</html>

